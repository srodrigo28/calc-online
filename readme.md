

#### SQL Estrutura + Views Inteligentes
````
-- ============================================================
-- üì¶ Tabela Principal: registros_financeiros
-- Armazena todos os lan√ßamentos financeiros do sistema
-- ============================================================
create table public.registros_financeiros (
  id bigint generated by default as identity primary key,
  nome text not null,
  tipo text check (tipo in ('entrada', 'saida')) not null,
  categoria text not null,
  quantidade numeric not null default 1,
  valor_unitario numeric not null,
  valor_total numeric not null,
  data_cadastro timestamp with time zone default now()
);

-- ============================================================
-- üëÅÔ∏è View 1: total_por_categoria
-- Soma o total de cada categoria, ideal para exibir os cards
-- ============================================================
create view public.total_por_categoria as
select
  categoria,
  sum(valor_total) as total
from
  registros_financeiros
group by
  categoria
order by
  categoria;

-- ============================================================
-- üëÅÔ∏è View 2: resumo_geral
-- Total de entradas, sa√≠das e c√°lculo de saldo de caixa
-- Ideal para os cards principais (verde, vermelho e azul)
-- ============================================================
create view public.resumo_geral as
select
  sum(case when tipo = 'entrada' then valor_total else 0 end) as total_entradas,
  sum(case when tipo = 'saida' then valor_total else 0 end) as total_saidas,
  sum(case when tipo = 'entrada' then valor_total else 0 end)
  - sum(case when tipo = 'saida' then valor_total else 0 end) as saldo_caixa
from
  registros_financeiros;

-- ============================================================
-- üëÅÔ∏è View 3: registros_detalhados
-- Exibe todos os registros j√° com o valor_total calculado
-- √ötil para evitar redund√¢ncia ou validar integridade
-- ============================================================
create view public.registros_detalhados as
select
  id,
  nome,
  tipo,
  categoria,
  quantidade,
  valor_unitario,
  quantidade * valor_unitario as valor_total,
  data_cadastro
from
  registros_financeiros;

-- ============================================================
-- üîí Dica adicional:
-- Ap√≥s criar essas estruturas, ative RLS e defina policies
-- para proteger acessos de acordo com o usu√°rio logado
-- ============================================================
-- example:
-- alter table public.registros_financeiros enable row level security;
-- create policy "Usu√°rio pode ler" on registros_financeiros
-- for select using (auth.uid() = user_id);

````

### Supa Key
```URL
https://qlmmdhklaqyxpdctykjk.supabase.co
```

```Key
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFsbW1kaGtsYXF5eHBkY3R5a2prIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg2MzMxNzEsImV4cCI6MjA2NDIwOTE3MX0.EZyjWN4QT-Yf5f46dUKSE-sfQoWMIXtIAQPsekQvqzA
```

### Iniciando os teste
```
-- Inser√ß√£o de dados simulados para testes
insert into public.registros_financeiros (nome, tipo, categoria, quantidade, valor_unitario, valor_total)
values
('Venda via Pix', 'entrada', 'infiniti-pix', 2, 150.00, 300.00),
('Compra de insumos', 'saida', 'freezer', 1, 220.00, 220.00),
('Pagamento via Cielo', 'entrada', 'cielo-cart√£o', 1, 500.00, 500.00),
('Saque do Caixa', 'saida', 'retiradas', 1, 100.00, 100.00),
('Dep√≥sito Inicial', 'entrada', 'caixa-inicial', 1, 1000.00, 1000.00),
('Pagamento de Contrato', 'saida', 'contratos', 1, 300.00, 300.00),
('Recebido em Dinheiro', 'entrada', 'dinheiro', 3, 50.00, 150.00),
('Venda via D√©bito', 'entrada', 'infiniti-d√©bito', 1, 250.00, 250.00);

-- reset
-- Remove todos os registros da tabela
truncate table public.registros_financeiros restart identity cascade;
```

### Rodar os testes
```
npm run inserir
npm run listar
npm run apagar
```